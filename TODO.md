## План: управление сессиями/контролем (переписать под требуемый алгоритм)

Алгоритм должен работать так (эти же кейсы проверяют тесты `session-control*`):

1. **Автозахват только один раз в `initSession()`**, и только если сервер вернул, что контроллера нет.
2. **Если сервер вернул, что контроллер уже есть** — в `initSession()` управление блокируется, UI генерирует новый токен сессии (сбрасывает старый), автоклейма нет. Дальше только кнопка «Забрать управление».
3. **При одновременном захвате** (свободное управление или просроченный keepalive) сервер гарантирует успех только первому; остальные получают ошибку (409/403).
4. **На периодических `refresh`**, если сервер возвращает, что управление свободно, UI лишь показывает кнопку «Забрать управление»; забрать может только пользователь явным кликом (никакого авто-claim). Если сервер говорит, что контроллер — наш токен, управление остаётся у нас.

Задачи:
- [x] Исправить UI/бекенд под правила 1–4.
- [x] Обновить Playwright-тесты `session-control*`, убедиться, что все зелёные.
- [x] Обновить документацию (DOCS/README/details) с новым алгоритмом.

Дополнительно:
- [x] Перенести хранение сессионного токена с `localStorage` на `sessionStorage` (изоляция вкладок); обновить UI и `tests/utils.ts`, прогнать тесты.
- [ ] Расширить диагностику: опциональный лог сетевого обмена, лог действий/запросов/ответов (с обрезкой строк).
- [ ] Выравнять таймауты Playwright до 10s (кроме заведомо долгих), добить сценарии рабочего списка и управления.

## Неизвестные датчики (нет в конфиге, есть в БД)

- [ ] Добавить флаг `--unknown-sensors-mode` (warn|strict|off):
  - warn (по умолчанию): считать unknown_count в выбранном окне, показывать предупреждение (N штук), список — только в диагностических логах.
  - strict: при unknown_count>0 возвращать ошибку (422/400) с числом неизвестных.
  - off: не считать unknown, не делать дополнительный запрос.
- [ ] Протянуть unknown_count в Postgres/SQLite (пока 0) или оставить заглушку с документированным ограничением.
- [ ] UI: отображение предупреждения по `unknown_count` (число), список только в диагностике при включённом логировании.
- [ ] Обновить DOCS/README/details с описанием режима unknown sensors и флага.
